---
title: "POG003"
---

```{r message=FALSE, warning=FALSE, include=FALSE}
source("required.R")
files <- c("POG003_2", "POG003_3", "POG003_4")
```

# Quality Control

## RNA

```{r warning=FALSE}
seuList <- list()
for(f in files){
  seuList[[f]] <- readRDS(paste0(path, f, "/rna_ProcessedSeurat.RDS"))
  
  # print 2 plots for each sample
  qc <- fread(paste0(path, f, "/QCMetrics_byCell.tsv"))
  
  output <- plotQC(f, qc)
  
  qcKeep <- dplyr::filter(qc, doublet == "singlet", discard == FALSE)
  print(f)
  print(paste("Number of cells:", nrow(qc), "| Number of cells kept:", ncol(seuList[[f]])))
  print(output)
}
```

## ATAC

```{r}

```

# SNV scores

```{r}
for(i in seq(1, length(seuList))){
  f <- names(seuList)[i]
  snvScores <- fread(paste0(path, f, "/snvScores_rnaFiltering.tsv")) %>%
    column_to_rownames(var = "barcode")
  
  seu <- seuList[[i]]
  seu <- AddMetaData(seu, snvScores)
  print(FeaturePlot(seu, reduction = "rna.umap", features = "snvScore") + 
          ggtitle(f) +
          labs(colour = "SNV Score"))
}
```








